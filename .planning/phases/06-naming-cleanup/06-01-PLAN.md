---
phase: 06-naming-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - md-quick-look/md-quick-look.xcodeproj/project.pbxproj
  - md-quick-look/md-quick-look/Info.plist
  - md-quick-look/md-quick-look Extension/Info.plist
  - md-quick-look/md-quick-look/PreviewViewController.swift
  - md-quick-look/md-quick-look/MarkdownRenderer.swift
  - md-quick-look/md-quick-look/MarkdownLayoutManager.swift
  - md-quick-look/md-quick-look/TableRenderer.swift
  - Makefile
autonomous: false

must_haves:
  truths:
    - "No 'spotlighter' references exist in codebase"
    - "No 'razielpanic' references exist in bundle identifiers"
    - "Bundle identifiers use 'com.rocketpop.MDQuickLook' pattern"
    - "User-facing name 'MD Quick Look' appears in all user-facing locations"
    - "Project builds successfully and 'MD Quick Look' appears in menu bar"
  artifacts:
    - path: "MDQuickLook/MDQuickLook.xcodeproj/project.pbxproj"
      provides: "Xcode project configuration with new naming"
      contains: "com.rocketpop.MDQuickLook"
    - path: "MDQuickLook/MDQuickLook/Info.plist"
      provides: "Main app bundle configuration"
      contains: "com.rocketpop.MDQuickLook"
    - path: "MDQuickLook/MDQuickLook Extension/Info.plist"
      provides: "Extension bundle configuration"
      contains: "com.rocketpop.MDQuickLook.Extension"
    - path: "Makefile"
      provides: "Build automation with new naming"
      contains: "MDQuickLook"
  key_links:
    - from: "project.pbxproj"
      to: "Info.plist paths"
      via: "INFOPLIST_FILE build setting"
      pattern: "MDQuickLook/Info.plist"
    - from: "Extension bundle ID"
      to: "Main app bundle ID"
      via: "prefix nesting"
      pattern: "com.rocketpop.MDQuickLook.Extension"
    - from: "PreviewViewController.swift"
      to: "OSLog subsystem"
      via: "Logger initialization"
      pattern: "com.rocketpop.MDQuickLook"
---

<objective>
Complete ALL codebase renaming from "md-quick-look" to "MDQuickLook" in a single atomic commit: directories, project configuration, Swift sources, Info.plist files, and Makefile.

Purpose: Honor the locked decision for "single atomic commit for all renaming changes" - all codebase changes happen together, providing a clean before/after boundary.

Output: Fully renamed codebase with verified build and runtime display name.
</objective>

<execution_context>
@gsd:workflows/execute-plan.md
@gsd:templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-naming-cleanup/06-CONTEXT.md
@.planning/phases/06-naming-cleanup/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename directories, update project.pbxproj and Makefile</name>
  <files>
    md-quick-look/md-quick-look/ (rename to MDQuickLook/)
    md-quick-look/md-quick-look.xcodeproj/ (rename to MDQuickLook.xcodeproj/)
    md-quick-look/ (rename to MDQuickLook/)
    project.pbxproj
    Makefile
  </files>
  <action>
    Use git mv with two-step renames (for case-sensitivity on macOS):

    1. Rename main app source directory:
       - `git mv md-quick-look/md-quick-look md-quick-look/temp-app`
       - `git mv md-quick-look/temp-app md-quick-look/MDQuickLook`

    2. Rename Xcode project directory:
       - `git mv md-quick-look/md-quick-look.xcodeproj md-quick-look/temp-proj.xcodeproj`
       - `git mv md-quick-look/temp-proj.xcodeproj md-quick-look/MDQuickLook.xcodeproj`

    3. Rename project folder:
       - `git mv md-quick-look temp-project`
       - `git mv temp-project MDQuickLook`

    4. Update project.pbxproj with these replacements (in order):
       - Replace all `"md-quick-look"` with `"MDQuickLook"` (quoted strings for target/product names)
       - Replace all `md-quick-look.app` with `MDQuickLook.app`
       - Replace all `com.razielpanic.md-quick-look.quicklook` with `com.rocketpop.MDQuickLook.Extension`
       - Replace all `com.razielpanic.md-quick-look` with `com.rocketpop.MDQuickLook`
       - Update INFOPLIST_FILE paths: `md-quick-look/Info.plist` -> `MDQuickLook/Info.plist`
       - Replace all `path = "md-quick-look"` with `path = "MDQuickLook"`

    5. Update Makefile:
       - PROJECT_DIR: `md-quick-look` -> `MDQuickLook`
       - SCHEME: `md-quick-look` -> `MDQuickLook`
       - APP_NAME: `md-quick-look.app` -> `MDQuickLook.app`
       - xcodebuild project path: `md-quick-look.xcodeproj` -> `MDQuickLook.xcodeproj`
       - killall command: `md-quick-look` -> `MDQuickLook`
       - Add cleanup of old app name in clean target: `rm -rf "$(INSTALL_DIR)/md-quick-look.app"`

    DO NOT commit yet - source file updates come next.
  </action>
  <verify>
    - `ls MDQuickLook/MDQuickLook.xcodeproj/` shows project.pbxproj
    - `ls MDQuickLook/MDQuickLook/` shows main.swift and Info.plist
    - `grep -r "spotlighter" MDQuickLook/MDQuickLook.xcodeproj/project.pbxproj` returns no matches
    - `grep "com.rocketpop.MDQuickLook" MDQuickLook/MDQuickLook.xcodeproj/project.pbxproj` returns matches
    - `grep "MDQuickLook" Makefile` returns matches (PROJECT_DIR, SCHEME, APP_NAME)
    - `grep "md-quick-look" Makefile` returns no matches (except cleanup command in clean target)
  </verify>
  <done>
    Directory structure renamed: md-quick-look/ -> MDQuickLook/, project.pbxproj and Makefile updated with new naming scheme.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Swift sources and Info.plist files</name>
  <files>
    MDQuickLook/MDQuickLook/PreviewViewController.swift
    MDQuickLook/MDQuickLook/MarkdownRenderer.swift
    MDQuickLook/MDQuickLook/MarkdownLayoutManager.swift
    MDQuickLook/MDQuickLook/TableRenderer.swift
    MDQuickLook/MDQuickLook/Info.plist
    MDQuickLook/MDQuickLook Extension/Info.plist
  </files>
  <action>
    **Swift files - OSLog subsystems:** Replace `com.razielpanic.md-quick-look` with `com.rocketpop.MDQuickLook` in:
    - PreviewViewController.swift: OSLog subsystem
    - MarkdownRenderer.swift: OSLog subsystem
    - MarkdownLayoutManager.swift: OSLog subsystem
    - TableRenderer.swift: OSLog subsystem

    **Swift files - Other references:**
    - PreviewViewController.swift: Change `"=== MD Quick Look Quick Look Extension ==="` to `"=== MD Quick Look Extension ==="`
    - PreviewViewController.swift: Change error domain `"MDSpotlighter"` to `"MDQuickLook"`

    **Info.plist files:**

    1. **Main App Info.plist**: `MDQuickLook/MDQuickLook/Info.plist`
       - Located in same directory as `main.swift`
       - Update:
         - CFBundleIdentifier: `com.razielpanic.md-quick-look` -> `com.rocketpop.MDQuickLook`
         - CFBundleName: `MD Quick Look` -> `MD Quick Look`

    2. **Extension Info.plist**: `MDQuickLook/MDQuickLook Extension/Info.plist`
       - Located in the directory with `PreviewViewController.swift`
       - Update:
         - CFBundleIdentifier: `com.razielpanic.md-quick-look.quicklook` -> `com.rocketpop.MDQuickLook.Extension`
         - CFBundleName: `.md for QuickLook` -> `MD Quick Look`
         - CFBundleDisplayName (if exists): -> `MD Quick Look`

    DO NOT commit yet - atomic commit comes in Task 3.
  </action>
  <verify>
    - `grep -r "spotlighter" MDQuickLook/MDQuickLook/*.swift` returns no matches
    - `grep -r "razielpanic" MDQuickLook/MDQuickLook/*.swift` returns no matches
    - `grep "com.rocketpop.MDQuickLook" MDQuickLook/MDQuickLook/PreviewViewController.swift` returns match
    - `plutil -lint MDQuickLook/MDQuickLook/Info.plist` shows "OK"
    - `grep "com.rocketpop.MDQuickLook.Extension" "MDQuickLook/MDQuickLook Extension/Info.plist"` returns match
    - `grep "MD Quick Look" MDQuickLook/MDQuickLook/Info.plist` returns match
  </verify>
  <done>
    All Swift source files and Info.plist files updated with new bundle identifiers, OSLog subsystems, and display names.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create atomic commit and verify build</name>
  <files>
    (all staged changes from Tasks 1 and 2)
  </files>
  <action>
    **Final verification before commit:**
    - `grep -ri "spotlighter" MDQuickLook/` should return no matches
    - `grep -ri "razielpanic" MDQuickLook/` should return no matches

    **Create single atomic commit:**
    - Stage all changes: `git add -A`
    - Commit with message:
      ```
      refactor(naming): rename project from md-quick-look to MD Quick Look

      - Rename Xcode project: md-quick-look.xcodeproj -> MDQuickLook.xcodeproj
      - Rename app source: md-quick-look/ -> MDQuickLook/
      - Update bundle IDs: com.rocketpop.MDQuickLook (app), com.rocketpop.MDQuickLook.Extension (extension)
      - Update display name: "MD Quick Look" in all user-facing locations
      - Update OSLog subsystems and error domains
      - Update Makefile build configuration

      All changes preserve git history via git mv renames.
      ```

    **Verify build succeeds:**
    - Run: `xcodebuild -project MDQuickLook/MDQuickLook.xcodeproj -scheme MDQuickLook -configuration Release -derivedDataPath build build`
    - Build must complete without errors
  </action>
  <verify>
    - `git log -1 --oneline` shows atomic commit with rename message
    - `grep -ri "spotlighter" MDQuickLook/` returns no matches
    - Build succeeds without errors
    - `ls build/Build/Products/Release/MDQuickLook.app` exists
  </verify>
  <done>
    Single atomic commit created with all codebase renaming changes. Build verified successful.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete codebase rename from "md-quick-look" to "MDQuickLook" in single atomic commit:
    - Directory structure: MDQuickLook/MDQuickLook.xcodeproj/, MDQuickLook/MDQuickLook/
    - Bundle IDs: com.rocketpop.MDQuickLook, com.rocketpop.MDQuickLook.Extension
    - Display name: "MD Quick Look" in Info.plist CFBundleName
    - All Swift files updated with new OSLog subsystems
    - Makefile updated with new paths
  </what-built>
  <how-to-verify>
    **Build verification:**
    1. Open Xcode: `open MDQuickLook/MDQuickLook.xcodeproj`
    2. Verify project structure in Project Navigator
    3. Build in Xcode (Cmd+B) - should succeed

    **Runtime verification (NAMING-04):**
    4. Run the app (Cmd+R) or install via: `make install`
    5. Open the app and verify "MD Quick Look" appears in the menu bar (Apple menu shows "MD Quick Look" as app name)
    6. Check About window shows "MD Quick Look" as the application name

    **Grep verification:**
    7. Run: `grep -ri "spotlighter" MDQuickLook/` - should return nothing
    8. Run: `grep -ri "razielpanic" MDQuickLook/` - should return nothing
  </how-to-verify>
  <resume-signal>Type "verified" to proceed with GitHub rename, or describe issues</resume-signal>
</task>

</tasks>

<verification>
**Plan verification checklist:**

1. **Directory structure correct:**
   - MDQuickLook/MDQuickLook.xcodeproj/ exists
   - MDQuickLook/MDQuickLook/ contains source files

2. **project.pbxproj updated:**
   - No "spotlighter" references
   - Bundle IDs use com.rocketpop.MDQuickLook pattern

3. **Swift sources updated:**
   - OSLog subsystems use com.rocketpop.MDQuickLook
   - Error domains use MDQuickLook

4. **Info.plist files updated:**
   - Display name "MD Quick Look" in both plists
   - Correct bundle identifiers

5. **Makefile updated:**
   - References new MDQuickLook paths
   - No stale references (except cleanup command)

6. **Single atomic commit:**
   - All changes in one commit
   - Build succeeds after commit

7. **Runtime verification (NAMING-04):**
   - "MD Quick Look" appears in menu bar when app runs
</verification>

<success_criteria>
- Zero "spotlighter" references in codebase
- Zero "razielpanic" references in bundle identifiers
- All changes in single atomic commit (per locked decision)
- Project compiles and builds successfully
- "MD Quick Look" appears in menu bar when running (NAMING-04)
</success_criteria>

<output>
After completion, create `.planning/phases/06-naming-cleanup/06-01-SUMMARY.md`
</output>
